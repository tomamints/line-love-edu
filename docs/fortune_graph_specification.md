# おつきさま診断 3ヶ月運勢グラフ仕様書

## 概要
直近3ヶ月の運勢を視覚的に表示するグラフシステムの仕様書。64パターンすべてに対応。

---

## 📊 グラフ基本仕様

### 表示期間
- **X軸**: 診断日から3ヶ月間（90日間）
- **単位**: 週単位（12週間）または月単位（3ヶ月）
- **開始点**: 診断日（0日目）

### 運勢レベル（Y軸）
```
レベル5: 絶好調 (100%)
レベル4: 好調 (80%)
レベル3: 普通 (60%)
レベル2: やや低調 (40%)
レベル1: 低調 (20%)
```

### グラフタイプ
- **メイングラフ**: 総合運（全体運）の波形
- **サブグラフ**: 5つの運勢カテゴリー別
  - 全体運
  - 恋愛運
  - 人間関係運
  - 仕事運
  - 金運

---

## 🌙 64パターン運勢データ構造

### データフォーマット
```json
{
  "pattern_id": "新月×新月",
  "pattern_number": 1,
  "fortune_graph": {
    "overall": {
      "month1": {
        "week1": 4, // 好調
        "week2": 5, // 絶好調
        "week3": 5, // 絶好調
        "week4": 4  // 好調
      },
      "month2": {
        "week1": 3, // 普通
        "week2": 4, // 好調
        "week3": 5, // 絶好調
        "week4": 5  // 絶好調
      },
      "month3": {
        "week1": 5, // 絶好調
        "week2": 4, // 好調
        "week3": 3, // 普通
        "week4": 4  // 好調
      }
    },
    "love": { /* 同様の構造 */ },
    "relationship": { /* 同様の構造 */ },
    "career": { /* 同様の構造 */ },
    "money": { /* 同様の構造 */ }
  },
  "key_dates": {
    "peak_dates": ["診断から2週目", "診断から6週目", "診断から9週目"],
    "caution_dates": ["診断から5週目", "診断から11週目"]
  }
}
```

---

## 📈 パターン別グラフ特性

### パターン1：新月×新月
```javascript
{
  "特徴": "急上昇型・変動大",
  "全体運": [4,5,5,4, 3,4,5,5, 5,4,3,4], // 週ごとのレベル
  "恋愛運": [5,5,4,3, 4,5,5,4, 3,4,5,5],
  "人間関係": [4,4,5,5, 4,3,4,5, 5,4,4,3],
  "仕事運": [5,5,5,4, 3,3,4,5, 5,5,4,4],
  "金運": [3,4,5,5, 4,3,3,4, 5,5,4,3]
}
```

### パターン2：新月×三日月
```javascript
{
  "特徴": "安定上昇型",
  "全体運": [3,4,4,5, 5,5,4,4, 4,5,5,4],
  "恋愛運": [3,3,4,4, 5,5,5,4, 4,4,5,5],
  "人間関係": [4,4,4,5, 5,5,5,4, 4,5,5,5],
  "仕事運": [3,4,4,4, 5,5,5,5, 4,4,5,5],
  "金運": [3,3,4,4, 4,5,5,4, 4,4,5,4]
}
```

### パターン3：新月×上弦
```javascript
{
  "特徴": "即効型・前半ピーク",
  "全体運": [5,5,5,4, 4,4,5,5, 4,3,3,4],
  "恋愛運": [5,5,4,4, 3,4,5,4, 4,3,4,4],
  "人間関係": [4,5,5,5, 4,4,4,5, 4,4,3,3],
  "仕事運": [5,5,5,5, 4,4,5,5, 5,4,4,3],
  "金運": [4,5,5,4, 4,3,4,5, 4,4,3,3]
}
```

### パターン4：新月×十三夜
```javascript
{
  "特徴": "成熟型・後半上昇",
  "全体運": [3,3,4,4, 4,5,5,5, 5,5,5,4],
  "恋愛運": [3,4,4,4, 5,5,5,5, 5,5,4,4],
  "人間関係": [3,3,4,5, 5,5,5,5, 5,5,5,4],
  "仕事運": [3,3,3,4, 4,5,5,5, 5,5,5,5],
  "金運": [3,3,4,4, 4,4,5,5, 5,5,4,4]
}
```

### パターン5：新月×満月
```javascript
{
  "特徴": "波動型・高低差大",
  "全体運": [5,4,3,5, 4,5,3,5, 4,5,3,4],
  "恋愛運": [5,5,3,4, 5,5,3,4, 5,5,3,3],
  "人間関係": [4,5,4,3, 5,4,5,3, 5,4,5,3],
  "仕事運": [5,4,4,5, 3,5,4,5, 3,5,4,4],
  "金運": [4,3,5,4, 3,5,3,5, 4,3,5,4]
}
```

### パターン6：新月×十六夜
```javascript
{
  "特徴": "安定型・中盤ピーク",
  "全体運": [3,4,4,4, 5,5,5,4, 4,4,4,3],
  "恋愛運": [3,3,4,5, 5,5,5,4, 4,3,3,3],
  "人間関係": [4,4,4,4, 5,5,5,5, 4,4,4,4],
  "仕事運": [3,4,4,5, 5,5,5,5, 4,4,3,3],
  "金運": [3,3,4,4, 5,5,4,4, 4,3,3,3]
}
```

### パターン7：新月×下弦
```javascript
{
  "特徴": "効率型・選択的上昇",
  "全体運": [4,3,5,3, 4,3,5,4, 3,5,4,4],
  "恋愛運": [3,3,4,3, 3,4,5,4, 4,5,4,3],
  "人間関係": [4,3,4,4, 3,4,5,5, 4,4,4,3],
  "仕事運": [5,3,5,3, 5,3,5,4, 4,5,5,4],
  "金運": [3,4,3,4, 3,5,3,5, 4,4,5,3]
}
```

### パターン8：新月×暁
```javascript
{
  "特徴": "神秘型・突発的上昇",
  "全体運": [3,3,5,3, 3,5,3,3, 5,3,3,5],
  "恋愛運": [3,4,5,3, 4,5,3,4, 5,3,4,5],
  "人間関係": [3,3,4,4, 3,5,4,3, 5,4,3,4],
  "仕事運": [3,3,5,3, 3,5,3,3, 5,3,3,5],
  "金運": [3,3,4,3, 4,5,3,4, 5,3,4,4]
}
```

---

## 🌈 三日月シリーズ（パターン9-16）

### パターン9：三日月×新月
```javascript
{
  "特徴": "優しい始動型",
  "全体運": [3,4,4,5, 4,4,5,5, 4,5,5,4],
  "恋愛運": [4,4,5,5, 5,4,4,5, 5,5,4,4],
  "人間関係": [4,5,5,5, 5,5,4,4, 5,5,5,4],
  "仕事運": [3,3,4,4, 4,5,5,5, 4,4,5,4],
  "金運": [3,4,4,4, 4,4,5,4, 4,5,4,4]
}
```

### パターン10：三日月×三日月
```javascript
{
  "特徴": "超安定型",
  "全体運": [4,4,4,4, 4,5,5,5, 5,5,4,4],
  "恋愛運": [4,4,5,5, 5,5,5,5, 4,4,4,4],
  "人間関係": [5,5,5,5, 5,5,5,5, 5,5,5,4],
  "仕事運": [4,4,4,4, 5,5,5,4, 4,4,4,4],
  "金運": [4,4,4,4, 4,5,5,4, 4,4,4,4]
}
```

### パターン11-16も同様のフォーマットで定義...

---

## 📊 視覚表現仕様

### グラフデザイン
```css
/* メインカラー（月相別） */
.moon-phase-colors {
  --新月: #1a1a2e;
  --三日月: #16213e;
  --上弦: #0f3460;
  --十三夜: #533483;
  --満月: #c70039;
  --十六夜: #900c3f;
  --下弦: #581845;
  --暁: #2e1a47;
}

/* レベル別背景色 */
.level-backgrounds {
  --絶好調: linear-gradient(180deg, #ffd700, #ffed4e);
  --好調: linear-gradient(180deg, #87ceeb, #b0e0e6);
  --普通: linear-gradient(180deg, #98fb98, #90ee90);
  --やや低調: linear-gradient(180deg, #dda0dd, #d8bfd8);
  --低調: linear-gradient(180deg, #778899, #696969);
}
```

### アニメーション仕様
- **描画アニメーション**: 左から右へ順次描画（2秒）
- **ポイントホバー**: 詳細情報をツールチップ表示
- **トランジション**: 0.3秒のイージング

---

## 🎯 重要ポイント表示

### ピークポイント（絶好調）
- 星マーク（⭐）で表示
- 具体的なアドバイステキスト表示
- 例：「2週目は恋愛運最高潮！告白のチャンス」

### 注意ポイント（低調）
- 注意マーク（⚠️）で表示
- 対策アドバイステキスト表示
- 例：「5週目は金運注意。大きな買い物は避けて」

---

## 📱 レスポンシブ対応

### PC版
- 横幅：800px
- 高さ：400px
- 5つのカテゴリーを同時表示

### スマホ版
- 横幅：100%（最大375px）
- 高さ：250px
- スワイプでカテゴリー切り替え

---

## 🔄 実装用データ生成ルール

### 月相組み合わせによる基本パターン

#### 上昇傾向の組み合わせ
- 新月×上弦：即効型
- 三日月×十三夜：安定上昇型
- 上弦×満月：爆発型

#### 下降傾向の組み合わせ
- 満月×下弦：徐々に下降型
- 十六夜×暁：緩やか下降型

#### 波動型の組み合わせ
- 新月×満月：激しい波動
- 上弦×下弦：規則的波動
- 三日月×暁：不規則波動

---

## 💾 全64パターンデータ

残りのパターン（17-64）も上記と同じフォーマットで定義。
各パターンは月相の特性を反映した独自の波形を持つ。

### データ生成アルゴリズム
```javascript
function generateFortuneGraph(moonPhase, hiddenMoonPhase) {
  const basePattern = getBasePattern(moonPhase);
  const modifier = getModifier(hiddenMoonPhase);
  const combined = combinePatterns(basePattern, modifier);
  return normalizeValues(combined, 1, 5);
}
```

---

## 📋 実装チェックリスト

- [ ] 64パターン全てのデータ定義
- [ ] グラフ描画ライブラリの選定（Chart.js推奨）
- [ ] レスポンシブデザインの実装
- [ ] アニメーション実装
- [ ] ツールチップ実装
- [ ] カラーテーマ実装
- [ ] ピーク・注意ポイント表示
- [ ] データ検証テスト