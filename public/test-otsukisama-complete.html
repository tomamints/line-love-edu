<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãŠã¤ãã•ã¾è¨ºæ–­ - çµ±åˆãƒ†ã‚¹ãƒˆ</title>
    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        .test-section {
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .test-header {
            background: #f0f0f0;
            padding: 10px;
            margin: -20px -20px 20px -20px;
            border-radius: 6px 6px 0 0;
        }
        .test-result {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeeba;
        }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background: #45a049;
        }
        .pattern-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
            margin: 20px 0;
        }
        .pattern-card {
            border: 1px solid #ddd;
            padding: 10px;
            border-radius: 4px;
            font-size: 12px;
        }
        .axis-test {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        .axis-item {
            flex: 1;
            min-width: 200px;
            border: 1px solid #ddd;
            padding: 10px;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <h1>ãŠã¤ãã•ã¾è¨ºæ–­ å®Œå…¨ç‰ˆ çµ±åˆãƒ†ã‚¹ãƒˆ</h1>
    
    <div class="test-section">
        <div class="test-header">
            <h2>ğŸ“Š ãƒ†ã‚¹ãƒˆæ¦‚è¦</h2>
        </div>
        <div id="test-summary"></div>
    </div>

    <div class="test-section">
        <div class="test-header">
            <h2>1ï¸âƒ£ ãƒ‡ãƒ¼ã‚¿ãƒ­ãƒ¼ãƒ€ãƒ¼ãƒ†ã‚¹ãƒˆ</h2>
        </div>
        <button onclick="testDataLoader()">ãƒ‡ãƒ¼ã‚¿ãƒ­ãƒ¼ãƒ€ãƒ¼ã‚’ãƒ†ã‚¹ãƒˆ</button>
        <div id="dataloader-results"></div>
    </div>

    <div class="test-section">
        <div class="test-header">
            <h2>2ï¸âƒ£ 4è»¸æ€§æ ¼è¦ç´ ãƒ†ã‚¹ãƒˆ</h2>
        </div>
        <button onclick="test4AxisPersonality()">4è»¸ã‚’ãƒ†ã‚¹ãƒˆ</button>
        <div class="axis-test" id="axis-test-container"></div>
        <div id="axis-results"></div>
    </div>

    <div class="test-section">
        <div class="test-header">
            <h2>3ï¸âƒ£ é‹å‹¢ã‚°ãƒ©ãƒ•ãƒ†ã‚¹ãƒˆ (64ãƒ‘ã‚¿ãƒ¼ãƒ³)</h2>
        </div>
        <button onclick="testFortuneGraphs()">å…¨ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ãƒ†ã‚¹ãƒˆ</button>
        <div id="graph-results"></div>
    </div>

    <div class="test-section">
        <div class="test-header">
            <h2>4ï¸âƒ£ ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒ†ã‚¹ãƒˆ</h2>
        </div>
        <button onclick="testCalendarPatterns()">ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚’ãƒ†ã‚¹ãƒˆ</button>
        <div id="calendar-results"></div>
    </div>

    <div class="test-section">
        <div class="test-header">
            <h2>5ï¸âƒ£ çµ±åˆå‹•ä½œãƒ†ã‚¹ãƒˆ</h2>
        </div>
        <button onclick="testIntegration()">çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
        <div id="integration-results"></div>
    </div>

    <script>
        const testResults = {
            dataLoader: false,
            fourAxis: false,
            fortuneGraph: false,
            calendar: false,
            integration: false
        };

        function updateSummary() {
            const summary = document.getElementById('test-summary');
            const total = Object.keys(testResults).length;
            const passed = Object.values(testResults).filter(v => v).length;
            const percentage = Math.round((passed / total) * 100);
            
            summary.innerHTML = `
                <div class="test-result ${percentage === 100 ? 'success' : percentage > 50 ? 'warning' : 'error'}">
                    <strong>ãƒ†ã‚¹ãƒˆé€²æ—:</strong> ${passed}/${total} (${percentage}%)
                    <br>
                    ãƒ‡ãƒ¼ã‚¿ãƒ­ãƒ¼ãƒ€ãƒ¼: ${testResults.dataLoader ? 'âœ…' : 'âŒ'}
                    | 4è»¸: ${testResults.fourAxis ? 'âœ…' : 'âŒ'}
                    | ã‚°ãƒ©ãƒ•: ${testResults.fortuneGraph ? 'âœ…' : 'âŒ'}
                    | ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼: ${testResults.calendar ? 'âœ…' : 'âŒ'}
                    | çµ±åˆ: ${testResults.integration ? 'âœ…' : 'âŒ'}
                </div>
            `;
        }

        async function testDataLoader() {
            const results = document.getElementById('dataloader-results');
            results.innerHTML = '<div class="warning">ãƒ†ã‚¹ãƒˆä¸­...</div>';
            
            try {
                // ãƒ‡ãƒ¼ã‚¿ãƒ­ãƒ¼ãƒ€ãƒ¼ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å‹•çš„ã«ãƒ­ãƒ¼ãƒ‰
                await loadScript('js/otsukisama-data-loader.js');
                
                // ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
                await window.OtsukisamaDataLoader.loadAllData();
                
                const tests = [
                    { name: 'ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒ‡ãƒ¼ã‚¿', test: () => window.OtsukisamaDataLoader.patternsData !== null },
                    { name: '3ã¤ã®åŠ›ãƒ‡ãƒ¼ã‚¿', test: () => window.OtsukisamaDataLoader.threePowersData !== null },
                    { name: 'æ€§æ ¼è»¸ãƒ‡ãƒ¼ã‚¿', test: () => window.OtsukisamaDataLoader.personalityAxesData !== null },
                    { name: 'æœˆç›¸èª¬æ˜', test: () => window.OtsukisamaDataLoader.moonPhasesData !== null },
                    { name: 'éš ã‚Œæœˆç›¸èª¬æ˜', test: () => window.OtsukisamaDataLoader.hiddenPhasesData !== null },
                    { name: 'UIãƒ†ã‚­ã‚¹ãƒˆ', test: () => window.OtsukisamaDataLoader.uiTextsData !== null }
                ];
                
                let html = '';
                let allPassed = true;
                
                for (const t of tests) {
                    const passed = t.test();
                    allPassed = allPassed && passed;
                    html += `<div class="test-result ${passed ? 'success' : 'error'}">
                        ${passed ? 'âœ…' : 'âŒ'} ${t.name}
                    </div>`;
                }
                
                // ãƒ‘ã‚¿ãƒ¼ãƒ³0ã®ãƒ†ã‚¹ãƒˆ
                const pattern0 = window.OtsukisamaDataLoader.getPatternFortune(0);
                if (pattern0) {
                    html += '<div class="test-result success">âœ… ãƒ‘ã‚¿ãƒ¼ãƒ³0ãƒ‡ãƒ¼ã‚¿å–å¾—æˆåŠŸ</div>';
                } else {
                    html += '<div class="test-result error">âŒ ãƒ‘ã‚¿ãƒ¼ãƒ³0ãƒ‡ãƒ¼ã‚¿å–å¾—å¤±æ•—</div>';
                    allPassed = false;
                }
                
                results.innerHTML = html;
                testResults.dataLoader = allPassed;
                updateSummary();
                
            } catch (error) {
                results.innerHTML = `<div class="test-result error">âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}</div>`;
                testResults.dataLoader = false;
                updateSummary();
            }
        }

        async function test4AxisPersonality() {
            const results = document.getElementById('axis-results');
            const container = document.getElementById('axis-test-container');
            results.innerHTML = '<div class="warning">ãƒ†ã‚¹ãƒˆä¸­...</div>';
            
            // ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿
            const testProfile = {
                emotionalExpression: 'ã‚¹ãƒˆãƒ¬ãƒ¼ãƒˆå‹',
                distanceStyle: 'ã˜ã£ãã‚Šå‹',
                loveValues: 'å®‰å¿ƒæ„Ÿé‡è¦–',
                loveEnergy: 'æƒ…ç†±çš„'
            };
            
            // localStorageã«ä¿å­˜
            localStorage.setItem('userPersonalityData', JSON.stringify(testProfile));
            
            try {
                // display.jsã‹ã‚‰é–¢æ•°ã‚’å–å¾—ã™ã‚‹ãŸã‚å‹•çš„ã«ãƒ­ãƒ¼ãƒ‰
                await loadScript('js/lp-otsukisama-display.js');
                
                // 4è»¸ã®è¡¨ç¤ºè¦ç´ ã‚’ä½œæˆ
                container.innerHTML = `
                    <div class="axis-item">
                        <h4>æ„Ÿæƒ…è¡¨ç¾</h4>
                        <div id="test-emotional-expression">-</div>
                    </div>
                    <div class="axis-item">
                        <h4>è·é›¢æ„Ÿ</h4>
                        <div id="test-distance-style">-</div>
                    </div>
                    <div class="axis-item">
                        <h4>ä¾¡å€¤è¦³</h4>
                        <div id="test-love-values">-</div>
                    </div>
                    <div class="axis-item">
                        <h4>ã‚¨ãƒãƒ«ã‚®ãƒ¼</h4>
                        <div id="test-love-energy">-</div>
                    </div>
                `;
                
                // ãƒãƒƒãƒ”ãƒ³ã‚°ãƒ†ã‚¹ãƒˆ
                const typeMapping = {
                    'ã‚¹ãƒˆãƒ¬ãƒ¼ãƒˆå‹': { name: 'ã‚¹ãƒˆãƒ¬ãƒ¼ãƒˆå‹', image: 'straight' },
                    'ã˜ã£ãã‚Šå‹': { name: 'ã˜ã£ãã‚Šå‹', image: 'slow' },
                    'å®‰å¿ƒæ„Ÿé‡è¦–': { name: 'å®‰å¿ƒæ„Ÿé‡è¦–', image: 'security' },
                    'æƒ…ç†±çš„': { name: 'æƒ…ç†±çš„', image: 'passionate' }
                };
                
                let allPassed = true;
                let html = '';
                
                // å„è»¸ã®ãƒ†ã‚¹ãƒˆ
                const axes = [
                    { key: 'emotionalExpression', label: 'æ„Ÿæƒ…è¡¨ç¾', expected: 'ã‚¹ãƒˆãƒ¬ãƒ¼ãƒˆå‹' },
                    { key: 'distanceStyle', label: 'è·é›¢æ„Ÿ', expected: 'ã˜ã£ãã‚Šå‹' },
                    { key: 'loveValues', label: 'ä¾¡å€¤è¦³', expected: 'å®‰å¿ƒæ„Ÿé‡è¦–' },
                    { key: 'loveEnergy', label: 'ã‚¨ãƒãƒ«ã‚®ãƒ¼', expected: 'æƒ…ç†±çš„' }
                ];
                
                for (const axis of axes) {
                    const value = testProfile[axis.key];
                    const mapped = typeMapping[value];
                    
                    if (mapped && mapped.name === axis.expected) {
                        html += `<div class="test-result success">âœ… ${axis.label}: ${axis.expected} â†’ æ­£å¸¸ãƒãƒƒãƒ”ãƒ³ã‚°</div>`;
                        document.getElementById(`test-${axis.key.replace(/([A-Z])/g, '-$1').toLowerCase()}`).textContent = axis.expected;
                    } else {
                        html += `<div class="test-result error">âŒ ${axis.label}: ãƒãƒƒãƒ”ãƒ³ã‚°å¤±æ•—</div>`;
                        allPassed = false;
                    }
                }
                
                results.innerHTML = html;
                testResults.fourAxis = allPassed;
                updateSummary();
                
            } catch (error) {
                results.innerHTML = `<div class="test-result error">âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}</div>`;
                testResults.fourAxis = false;
                updateSummary();
            }
        }

        async function testFortuneGraphs() {
            const results = document.getElementById('graph-results');
            results.innerHTML = '<div class="warning">ãƒ†ã‚¹ãƒˆä¸­...</div>';
            
            try {
                // ã‚°ãƒ©ãƒ•ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿
                const response = await fetch('../docs/fortune_graph_all_64_patterns.json');
                const data = await response.json();
                
                let html = '';
                let allPassed = true;
                
                // é…åˆ—å½¢å¼ã®ãƒ‡ãƒ¼ã‚¿ã‚’ãƒã‚§ãƒƒã‚¯
                if (!data.patterns || !Array.isArray(data.patterns)) {
                    html = '<div class="test-result error">âŒ ãƒ‡ãƒ¼ã‚¿å½¢å¼ãŒä¸æ­£ã§ã™</div>';
                    allPassed = false;
                } else if (data.patterns.length !== 64) {
                    html = `<div class="test-result error">âŒ ãƒ‘ã‚¿ãƒ¼ãƒ³æ•°ãŒä¸æ­£: ${data.patterns.length}/64</div>`;
                    allPassed = false;
                } else {
                    // å…¨64ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ãƒ†ã‚¹ãƒˆ
                    for (let i = 0; i < data.patterns.length; i++) {
                        const pattern = data.patterns[i];
                        
                        if (!pattern) {
                            html += `<div class="test-result error">âŒ ãƒ‘ã‚¿ãƒ¼ãƒ³${i}: ãƒ‡ãƒ¼ã‚¿ãªã—</div>`;
                            allPassed = false;
                            continue;
                        }
                        
                        // fortune_dataã®æ§‹é€ ã‚’ãƒã‚§ãƒƒã‚¯
                        if (!pattern.fortune_data) {
                            html += `<div class="test-result error">âŒ ãƒ‘ã‚¿ãƒ¼ãƒ³${i}: fortune_dataãªã—</div>`;
                            allPassed = false;
                        } else {
                            const fortuneData = pattern.fortune_data;
                            const requiredKeys = ['overall', 'love', 'relationship', 'career', 'money'];
                            
                            for (const key of requiredKeys) {
                                if (!fortuneData[key] || fortuneData[key].length !== 12) {
                                    html += `<div class="test-result error">âŒ ãƒ‘ã‚¿ãƒ¼ãƒ³${i}: ${key}ãƒ‡ãƒ¼ã‚¿ä¸æ­£</div>`;
                                    allPassed = false;
                                    break;
                                }
                            }
                        }
                    }
                }
                
                if (allPassed) {
                    html = '<div class="test-result success">âœ… å…¨64ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ã‚°ãƒ©ãƒ•ãƒ‡ãƒ¼ã‚¿ãŒæ­£å¸¸</div>';
                    
                    // ã‚µãƒ³ãƒ—ãƒ«ãƒ‘ã‚¿ãƒ¼ãƒ³ã®è©³ç´°è¡¨ç¤º
                    const sampleIndices = [0, 17, 35, 63];
                    html += '<div class="pattern-grid">';
                    for (const idx of sampleIndices) {
                        const pattern = data.patterns[idx];
                        if (pattern && pattern.fortune_data && pattern.fortune_data.overall) {
                            html += `
                                <div class="pattern-card">
                                    <strong>ãƒ‘ã‚¿ãƒ¼ãƒ³${idx}: ${pattern.pattern_id}</strong><br>
                                    ç‰¹å¾´: ${pattern.characteristics}<br>
                                    ç·åˆé‹: [${pattern.fortune_data.overall.slice(0, 3).join(', ')}...]<br>
                                    å¹³å‡: ${Math.round(pattern.fortune_data.overall.reduce((a, b) => a + b) / 12)}
                                </div>
                            `;
                        }
                    }
                    html += '</div>';
                }
                
                results.innerHTML = html;
                testResults.fortuneGraph = allPassed;
                updateSummary();
                
            } catch (error) {
                results.innerHTML = `<div class="test-result error">âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}</div>`;
                testResults.fortuneGraph = false;
                updateSummary();
            }
        }

        async function testCalendarPatterns() {
            const results = document.getElementById('calendar-results');
            results.innerHTML = '<div class="warning">ãƒ†ã‚¹ãƒˆä¸­...</div>';
            
            try {
                // ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿
                const response = await fetch('data/moon-calendar-patterns-complete.json');
                const data = await response.json();
                
                let html = '';
                let allPassed = true;
                
                // patternsã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å­˜åœ¨ç¢ºèª
                if (!data.patterns || typeof data.patterns !== 'object') {
                    html = '<div class="test-result error">âŒ ãƒ‡ãƒ¼ã‚¿å½¢å¼ãŒä¸æ­£ã§ã™</div>';
                    allPassed = false;
                } else {
                    // å…¨64ãƒ‘ã‚¿ãƒ¼ãƒ³ã®å­˜åœ¨ç¢ºèªï¼ˆæ•°å­—ã‚­ãƒ¼å½¢å¼ï¼‰
                    for (let i = 0; i < 64; i++) {
                        const patternKey = i.toString();
                        const pattern = data.patterns[patternKey];
                        
                        if (!pattern) {
                            html += `<div class="test-result error">âŒ ãƒ‘ã‚¿ãƒ¼ãƒ³${patternKey}: ãƒ‡ãƒ¼ã‚¿ãªã—</div>`;
                            allPassed = false;
                            continue;
                        }
                        
                        // å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ç¢ºèª
                        const requiredFields = ['lucky_days', 'power_days', 'caution_days', 'special_marks', 'monthly_message', 'love_advice'];
                        for (const field of requiredFields) {
                            if (!pattern[field]) {
                                html += `<div class="test-result error">âŒ ãƒ‘ã‚¿ãƒ¼ãƒ³${patternKey}: ${field}ãªã—</div>`;
                                allPassed = false;
                            }
                        }
                    }
                }
                
                if (allPassed) {
                    html = '<div class="test-result success">âœ… å…¨64ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒ‡ãƒ¼ã‚¿ãŒæ­£å¸¸</div>';
                    
                    // ã‚µãƒ³ãƒ—ãƒ«ãƒ‘ã‚¿ãƒ¼ãƒ³ã®è©³ç´°
                    const samplePattern = data.patterns['0'];
                    if (samplePattern) {
                        html += `
                            <div class="test-result success">
                                <strong>ãƒ‘ã‚¿ãƒ¼ãƒ³0ã‚µãƒ³ãƒ—ãƒ« (${samplePattern.pattern_id}):</strong><br>
                                ãƒ©ãƒƒã‚­ãƒ¼ãƒ‡ãƒ¼: ${samplePattern.lucky_days.join(', ')}<br>
                                ãƒ‘ãƒ¯ãƒ¼ãƒ‡ãƒ¼: ${samplePattern.power_days.join(', ')}<br>
                                æ³¨æ„æ—¥: ${samplePattern.caution_days.join(', ')}<br>
                                æœˆé–“ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: ${samplePattern.monthly_message.substring(0, 50)}...
                            </div>
                        `;
                    }
                }
                
                results.innerHTML = html;
                testResults.calendar = allPassed;
                updateSummary();
                
            } catch (error) {
                results.innerHTML = `<div class="test-result error">âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}</div>`;
                testResults.calendar = false;
                updateSummary();
            }
        }

        async function testIntegration() {
            const results = document.getElementById('integration-results');
            results.innerHTML = '<div class="warning">çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­...</div>';
            
            try {
                // å…¨ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ãƒ­ãƒ¼ãƒ‰ãƒ†ã‚¹ãƒˆ
                const scripts = [
                    'js/otsukisama-data-loader.js',
                    'js/lp-otsukisama-display.js',
                    'js/lp-otsukisama-graph.js',
                    'js/lp-otsukisama-calendar.js',
                    'js/lp-otsukisama-api.js'
                ];
                
                let html = '';
                let allPassed = true;
                
                for (const script of scripts) {
                    try {
                        await loadScript(script);
                        html += `<div class="test-result success">âœ… ${script} ãƒ­ãƒ¼ãƒ‰æˆåŠŸ</div>`;
                    } catch (error) {
                        html += `<div class="test-result error">âŒ ${script} ãƒ­ãƒ¼ãƒ‰å¤±æ•—</div>`;
                        allPassed = false;
                    }
                }
                
                // çµ±åˆå‹•ä½œãƒ†ã‚¹ãƒˆ
                if (allPassed) {
                    // ãƒ‘ã‚¿ãƒ¼ãƒ³IDç”Ÿæˆãƒ†ã‚¹ãƒˆ
                    const testDate = { year: 2000, month: 1, day: 1 };
                    if (typeof generatePatternId === 'function') {
                        const patternId = generatePatternId(testDate.year, testDate.month, testDate.day);
                        html += `<div class="test-result success">âœ… ãƒ‘ã‚¿ãƒ¼ãƒ³IDç”Ÿæˆ: ${patternId}</div>`;
                    } else {
                        html += `<div class="test-result error">âŒ generatePatternIdé–¢æ•°ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“</div>`;
                        allPassed = false;
                    }
                    
                    // ãƒ‡ãƒ¼ã‚¿ãƒ­ãƒ¼ãƒ€ãƒ¼åˆæœŸåŒ–ãƒ†ã‚¹ãƒˆ
                    if (window.OtsukisamaDataLoader && window.OtsukisamaDataLoader.isLoaded) {
                        html += `<div class="test-result success">âœ… ãƒ‡ãƒ¼ã‚¿ãƒ­ãƒ¼ãƒ€ãƒ¼åˆæœŸåŒ–æ¸ˆã¿</div>`;
                    } else {
                        html += `<div class="test-result warning">âš ï¸ ãƒ‡ãƒ¼ã‚¿ãƒ­ãƒ¼ãƒ€ãƒ¼æœªåˆæœŸåŒ–</div>`;
                    }
                }
                
                results.innerHTML = html;
                testResults.integration = allPassed;
                updateSummary();
                
            } catch (error) {
                results.innerHTML = `<div class="test-result error">âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}</div>`;
                testResults.integration = false;
                updateSummary();
            }
        }

        function loadScript(src) {
            return new Promise((resolve, reject) => {
                // æ—¢ã«ãƒ­ãƒ¼ãƒ‰æ¸ˆã¿ã‹ãƒã‚§ãƒƒã‚¯
                if (document.querySelector(`script[src="${src}"]`)) {
                    resolve();
                    return;
                }
                
                const script = document.createElement('script');
                script.src = src;
                script.onload = resolve;
                script.onerror = reject;
                document.head.appendChild(script);
            });
        }

        // åˆæœŸè¡¨ç¤º
        updateSummary();
    </script>
</body>
</html>